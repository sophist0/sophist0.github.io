<html>
<head>
<title>Maze Generation Notes</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="maze.css">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div class="hspacer"></div>
<div class="content_block">
<h1>Maze Generation Notes</h1>
<hr>
<p>
I needed to generate mazes for a project. I wanted to generate mazes of size $n$ ranging from $n=10$ to about $n=100$. Simple problem right, get a grid and start dropping walls. Wrong! It turns out that a maze where every location is accessible and there are no loops is equivalent to a spanning tree. A spanning tree is a path which visits every node in a graph exactly once without any cycles. Spanning trees appear some path finding algorithms but are interesting mathematical objects in their own right.
</p>
<p>
Although I have a background in graph theory, spanning trees were not my first thought when it came to maze generation, instead I thought of a random walk, a simple random walk to be specific. In a simple random walk given the walks current location you move with equal probability to every adjacent space or node, and the process repeats possibly forever.
</p>
<p>
So say $n=5$ meaning our maze is a grid with $5$ spaces on each side and $25$ spaces in total. Also lets define the maze entrance to be at space $(0,0)$ and exit to be at $(4,4)$. This gives the grid below.
</p>
<div class="grid-container">
<div class="grid-item">
<div class="grid-spacer"></div>
$(0,0)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(0,1)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(0,2)$
<div class="grid-spacer"></div>
</div>
  
<div class="grid-item">
<div class="grid-spacer"></div>
$(0,3)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(0,4)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(1,0)$
<div class="grid-spacer"></div>
</div>  

<div class="grid-item">
<div class="grid-spacer"></div>
$(1,1)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(1,2)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(1,3)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(1,4)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(2,0)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(2,1)$
<div class="grid-spacer"></div>
</div>
 
<div class="grid-item">
<div class="grid-spacer"></div>
$(2,2)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(2,3)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(2,4)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(3,0)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(3,1)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(3,2)$
<div class="grid-spacer"></div>
</div>  

<div class="grid-item">
<div class="grid-spacer"></div>
$(3,3)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(3,4)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(4,0)$
<div class="grid-spacer"></div>
</div>  

<div class="grid-item">
<div class="grid-spacer"></div>
$(4,1)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(4,2)$
<div class="grid-spacer"></div>
</div>

<div class="grid-item">
<div class="grid-spacer"></div>
$(4,3)$
<div class="grid-spacer"></div>
</div>
  
<div class="grid-item">
<div class="grid-spacer"></div>
$(4,4)$
<div class="grid-spacer"></div>
</div>
</div>
<p>
If the simple random walk is at space $(0,0)$ and diagonal moves are not allowed then it has $\frac{1}{2}$ probability of moving to space $(0,1)$ and $\frac{1}{2}$ probability of moving to space $(1,0)$. If the random walk is allowed to backtrack, i.e. if the random walk is at space $(0,1)$ it is allowed to return to space $(0,0)$ then the random walk will continue indefinitely eventually visiting every space. Therefore if the random walk starts in location $(0,0)$ and we terminate it when it reaches space $(4,4)$ we have a random path from space $(0,0)$ to $(4,4)$.
</p>

<p>
Of course this path may have loops and may either visit every space in our grid or only $9$ of the $25$ spaces. These are all potential problems with our generated maze but there is a more subtle problem. To see this ask assuming the random walk starts at $(0,0)$ and is not allowed to backtrack, what is the probability that on the second move the random walk arrives are space $(0,2)$? If the random walk arrives at space $(0,2)$ on the second move it had to be at space $(0,1)$ after the first move. So given that the probability of moving to space $(0,1)$ on the first move is $\frac{1}{2}$ and the given the random walk is at $(0,1)$ the probability of it moving to location $(0,2)$ is also $\frac{1}{2}$, the probability of arriving at space $(0,2)$ on the second move can be computed as follows,
\begin{align}
P((0,1)|(0,0)) 	&= \frac{1}{2}\\
P((0,2)|(0,1)) 	&= \frac{1}{2}\\
P((0,2)|(0,0)) 	&= P((0,1)|(0,0)) P((0,2)|(0,1)\\ 
		&= \frac{1}{4}
\end{align}
Now ask what is the probability of arriving at space $(1,1)$ on the second move? Well its
\begin{align}
P((1,1)|(0,0)) 	&= P((0,1)|(0,0)) P((1,1)|(0,1) + P((1,0)|(0,0)) P((1,1)|(1,0)\\
		&= \frac{1}{4} + \frac{1}{4}\\
		&= \frac{1}{2}
\end{align}
In other words, the random walk is more likely to visit spaces along the diagonal then spaces along the edge of the grid. This is shown numerically in the two heatmaps below. These are generated from $1000$ random walks starting at $(0,0)$ and ending at $(7,7)$. The figure on the left counts all visits to a space and we see that the random walks spend most of their time near where they begin at space $(0,0)$. But since we are uninterested in repeated visits to a space in maze generation the right is more useful, it counts each time a space was visited at least once in each of the $1000$ random walks from $(0,0)$ to $(7,7)$. Here it is clear that nearly all random walks pass through the spaces along the diagonal from space $(0,0)$ to $(7,7)$ but only about half make it to spaces $(0,7)$ and $(7,0)$.
<div class="heatmap_wrapper">
<img class="heatmap_l" src="images/maze/AllCnt_rw1.png">
<img class="heatmap_r" src="images/maze/cnt_rw1.png">
</div>
</p>
<p>
This is a problem because it means the maze generated by this random walk will likely be solvable by simply traversing the diagonal. To rectify this instead of using a simple random walk which moves to all adjacent squares with equal probability, I decided adjust the transition probabilities so that the random walk is more likely to visit edge spaces such as $(0,7)$ and $(7,0)$. <b>Using discrete time Markov chain theory there may be an exact solution for the transition probabilities required such that the probability of taking any path across the grid is equal but it likely depends on $m$ the length of the path. (Look into!!) But not knowing $m$ a priori, being unsure how exactly how to formulate the problem in terms of Markov chains, and generally being lazy, I choose to try a rough approximation.</b> The basic problem we observed above is that if we approximate the undirected graph the simple random walk traverses as a directed graph, the probability of visiting space $(1,1)$ at $m=2$ is twice that of visiting space $(0,2)$. The following figures show the true undirected graph on the left and my approximation of it with a directed graph on the right for $n=3$.
</p>
<div class="heatmap_wrapper">
<img class="heatmap_l" src="images/maze/undirected_graph.png">
<img class="heatmap_r" src="images/maze/directed_graph.png">
</div>

I decided to try a random walk biasing scheme that should push the random walk toward the edges of the maze. The figure below gives the bias scheme, bias $2^0=1$ for the diagonal nodes $(0,0)$, $(1,1)$, and $(2,2)$, bias of $2^1=2$ for $1$ step left and right of the diagonal, and generally $2^x$ for $x$ steps off the diagonal. More generally letting the tuple indexing each node be represented as $(i,j)$ we can compute $x$ as $x=abs(i-j)$ and therefore the bias at node $(i,j)$ is $b_{i,j}=2^{abs(i-j)}$.
<img class="biased_graph" src="images/maze/baised_directed_v1.png">
These biases can be put into a transition matrix and then row normalized so the probability of leaving any space is $1$. In the transition matrix below $n=3$ and row and column labels correspond to the numbers in the lower left corners of the biasing figure above.

<br>
<div class="grid-container-2">
<div class="grid-edge-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$1$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$2$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$3$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$4$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$5$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$6$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$7$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$8$
<div class="grid-spacer-2"></div>
</div>
  
<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>  

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>
 
<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$1$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{2}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>  

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>  

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$2$
<div class="grid-spacer-2"></div>
</div>
  
<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$3$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{2}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$4$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$5$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{2}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$6$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$7$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{2}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$8$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>

<div class="grid-item-2">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-item-2">
</div>
</div>
<p>
Running a random walk $1000$ times using this biasing scheme with a grid of size $n=8$ gives the following heatmaps. The one on the left counts all visits to a space and the one on the right just the first visit. In both its clear that the edge spaces are visited more often then in the case of the unbiased random walk, in fact the diagonal spaces are now less visited than the edge spaces.

<div class="heatmap_wrapper">
<img class="heatmap_l" src="images/maze/AllCnt_rw2.png">
<img class="heatmap_r" src="images/maze/cnt_rw2.png">
</div>
We can moderate this biasing of the random walk toward the edge spaces by adding a constant $c$ as follows, 
\begin{equation}
b_{i,j} = 2^{floor\left({\frac{abs(i-j)}{c}}\right)}
\end{equation}
where $floor()$ if the floor function although it is not strictly required. Notice if $c=1$ the random walk's bias is the same as in the figures above and as $c\to\infty$ the random walk approaches an unbiased random walk since $b_{i,j}\to1$ for all $i$ and $j$. For instance letting $c=2$ and running the biased random walk $1000$ times gives the following heatmaps which fall somewhere between the first unbiased random walk and the second biased random walk.
<div class="heatmap_wrapper">
<img class="heatmap_l" src="images/maze/AllCnt_rw3.png">
<img class="heatmap_r" src="images/maze/cnt_rw3.png">
</div>
My original thought was that it might be possible to find a parameterization of $c$ such that the probability the random walk generating any path from space $(0,0)$ to $(n-1,n-1)$ would be equal, implying that the heatmaps on the left would be a uniform color within a small margin of error. However I am not sure that such a parameterization of $c$ exists. Instead I think it more likely that my justification of the biasing scheme which approximated an undirected graph as a directed graph is obscuring dynamics which the parameterization of $c$ does not account for. It might be worth comparing the mazes generated using this biased random walk technique to those generated using Wilson's algorithm which selects a maze or spanning tree from the set of spanning trees with uniform probability. Some of the questions I have are how much less uniform are the spanning trees generated using this biased random walk then Wilson's algorithm, which spanning tree generation technique is more computationally intensive, are these questions even well posed?
</p>
<p>
Adding some additional ad-hoc techniques to fill out the maze with branches from solution path generated using the biased random walk technique described above gives an algorithm that can produce an arbitrarily sized maze such as the one shown below.
</p>

<div class="grid-container-2">
<div class="grid-edge-2">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$1$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$2$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$3$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$4$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$5$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$6$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$7$
<div class="grid-spacer-2"></div>
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$8$
<div class="grid-spacer-2"></div>
</div>
  
<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
Start
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
</div>  

<div class="edge-6">
</div>

<div class="edge-12">
</div>

<div class="edge-5">
</div>

<div class="edge-3">
</div>

<div class="edge-12">
</div>

<div class="edge-12">
</div>
 
<div class="edge-5">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$1$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
</div>

<div class="edge-8">
</div>

<div class="edge-13">
</div>

<div class="edge-6">
</div>  

<div class="edge-7">
</div>

<div class="edge-6">
</div>

<div class="edge-10">
</div>  

<div class="edge-12">
</div>

<div class="edge-7">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$2$
<div class="grid-spacer-2"></div>
</div>
  
<div class="edge-6">
</div>

<div class="edge-7">
</div>

<div class="edge-2">
</div>

<div class="edge-9">
</div>

<div class="edge-12">
</div>

<div class="edge-7">
</div>

<div class="edge-4">
</div>

<div class="edge-12">
</div>

<div class="edge-5">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$3$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-9">
</div>

<div class="edge-1">
</div>

<div class="edge-6">
</div>

<div class="edge-7">
</div>

<div class="edge-0">
</div>

<div class="edge-6">
</div>

<div class="edge-5">
</div>

<div class="edge-0">
</div>

<div class="edge-13">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$4$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-9">
</div>

<div class="edge-12">
</div>

<div class="edge-7">
</div>

<div class="edge-6">
</div>

<div class="edge-7">
</div>

<div class="edge-13">
</div>

<div class="edge-4">
</div>

<div class="edge-8">
</div>

<div class="edge-13">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$5$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-9">
</div>

<div class="edge-12">
</div>

<div class="edge-1">
</div>

<div class="edge-9">
</div>

<div class="edge-1">
</div>

<div class="edge-4">
</div>

<div class="edge-5">
</div>

<div class="edge-4">
</div>

<div class="edge-7">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$6$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-9">
</div>

<div class="edge-1">
</div>

<div class="edge-6">
</div>

<div class="edge-11">
</div>

<div class="edge-10">
</div>

<div class="edge-1">
</div>

<div class="edge-4">
</div>

<div class="edge-12">
</div>

<div class="edge-5">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$7$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
</div>

<div class="edge-12">
</div>

<div class="edge-11">
</div>

<div class="edge-5">
</div>

<div class="edge-4">
</div>

<div class="edge-12">
</div>

<div class="edge-12">
</div>

<div class="edge-5">
</div>

<div class="edge-13">
</div>

<div class="grid-edge-2">
<div class="grid-spacer-2"></div>
$8$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
</div>

<div class="edge-12">
</div>

<div class="edge-12">
</div>

<div class="edge-7">
</div>

<div class="edge-3">
</div>

<div class="edge-12">
</div>

<div class="edge-12">
</div>

<div class="edge-7">
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
End
<div class="grid-spacer-2"></div>
</div>
</div>


<h2>To Do</h2>
<hr>
Compare my method of maze generation against several other methods such as Randomized Kruskal's algorithm and Wilson's algorithm. 
<p>
<b>Sources:</b><br>
$^{(1)}$ <a href="https://en.wikipedia.org/wiki/Spanning_tree">https://en.wikipedia.org/wiki/Spanning_tree</a><br>
$^{(2)}$ <a href="https://en.wikipedia.org/wiki/Maze_generation_algorithm">https://en.wikipedia.org/wiki/Maze_generation_algorithm</a><br>
$^{(3)}$<a href="http://www.astrolog.org/labyrnth/algrithm.htm">http://www.astrolog.org/labyrnth/algrithm.htm</a><br>
</p>
<hr>
<div class="hspacer"></div>

<h1>A More Exact Solution</h1>
<hr>
<p>
In passing I mentioned that there might be an exact solution that could be found for a biased transition matrix given a desired probability distribution of visiting each space in the grid. Well I'm still not sure exactly how this maps onto Markov chain theory nor have I tested the following numerically but I will give the general thrust of a solution.
</p>
<p>
Say $n=3$, we have $9$ states, and we start at state $0$ with absorbing state $8$. Now lets look at how the probability of the walk being in a given state changes with each step.
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
1
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
2
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
3
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
4
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
5
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
6
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
7
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
8
<div class="grid-spacer-2"></div>
</div>
</div>

<div class="store_step">
<hr>
$step=0$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
1
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=1$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=2$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
$\frac{1}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
$\frac{1}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=3$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{1}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{1}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=4$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
$\frac{2}{9}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
$\frac{1}{3}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
$\frac{1}{9}$
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=5$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{5}{18}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{5}{18}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$\frac{1}{6}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>
</p>

<p>
Notice that since state $9$ is an absorbing state it acts as a probability sink in step $5$. Basically you see waves of probability slowly sinking into the absorbing state. What patterns can we draw from this?
</p>
<table style="width:100%">
  <tr>
    <th>Step</th>
    <th>Possible States</th> 
    <th>Number of Possible States</th>
  </tr>
  <tr>
     <th>$0$</th>
     <th>$0$</th> 
     <th>$2^0$</th>
  </tr>
  <tr>
    <th>$1$</th>
    <th>$1,3$</th>
    <th>$2^1$</th>
  </tr>
  <tr>
    <th>$2$</th>
    <th>$0,2,4,6$</th>
    <th>$2^2$</th>
  </tr>
  <tr>
    <th>$3$</th>
    <th>$1,3,5,7$</th>
    <th>$2^2$</th>
  </tr>
  <tr>
    <th>$4$</th>
    <th>$0,2,4,6,8$</th>
    <th>$2^2+2^0$</th>
  </tr>
  <tr>
    <th>$5$</th>
    <th>$1,3,5,7$</th>
    <th>$2^2$</th>
  </tr>
</table>
<p>
There is actually less of a pattern in the growth of number of possible states in each step then there first appears. If we look at a grid of size $n=4$ we see the pattern break down. 
</p>
<table style="width:100%">
  <tr>
    <th>Step</th>
    <th>Possible States</th> 
    <th>Number of Possible States</th>
  </tr>
  <tr>
     <th>$0$</th>
     <th>$0$</th> 
     <th>$2^0$</th>
  </tr>
  <tr>
    <th>$1$</th>
    <th>$1,4$</th>
    <th>$2^1$</th>
  </tr>
  <tr>
    <th>$2$</th>
    <th>$0,2,5,8$</th>
    <th>$2^2$</th>
  </tr>
  <tr>
    <th>$3$</th>
    <th>$1,4,3,6,9,12$</th>
    <th>$2^2+2^1$</th>
  </tr>
  <tr>
    <th>$4$</th>
    <th>$0,2,5,8,7,10,13$</th>
    <th>$2^2+2^1+2^0$</th>
  </tr>
  <tr>
    <th>$5$</th>
    <th>$1,4,3,6,9,12,11,14$</th>
    <th>$2^3$</th>
  </tr>
  <tr>
    <th>$6$</th>
    <th>$0,2,5,8,7,10,13,15$</th>
    <th>$2^3$</th>
  </tr>
  <tr>
    <th>$7$</th>
    <th>$1,4,3,6,9,12,11,14$</th>
    <th>$2^3$</th>
  </tr>
</table>
<p>
Maybe if I looked at more examples I could find an equation for this number but I'm not sure how important it is and likely someone else has already derived it.
</p>

My goal is to change the probability of being at each state for $n=3$ to be the following.

<div class="store_step">
<hr>
$step=0$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
1
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=1$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{1}{2}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=2$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=3$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$\frac{1}{4}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=4$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$0$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>
</div>

<!-- ######################################################## --!>

<div class="store_step">
<hr>
$step=5$
</div>
<div class="grid-container-3">
<div class="edge-6">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-0">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-5">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-3">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-15">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-1">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-4">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>

<div class="edge-2">
<div class="grid-spacer-2"></div>
$\frac{1}{5}$
<div class="grid-spacer-2"></div>
</div>

<div class="edge-7">
<div class="grid-spacer-2"></div>
0
<div class="grid-spacer-2"></div>
</div>
</div>
</p>
<p>
Lets define the grid state at $step=0$ as a vector $v_0$, the grid state at $step=1$ as $v_1$, and the grid state at $step=i$ as $v_i$. Each vector $v_i$ is straightforward to compute given $v_0$. The question is how to compute a transition matrix $T_{0,1}$ given vectors $v_0$ and $v_1$? This is simple to express,

\begin{align}
v_0 T_{0,1}	&=	v_1\\
T_{0,1}		&=	v_0^{-1}v_1
\end{align}

Unfortunately the inverse of $v_0$ does not exist since it is not a square matrix. But since $v_0$ is a row matrix consisting of a single column it follows that its columns are independent. Therefore
$$
v_0^+v_0 = I
$$
where $v_0^+$ is the Moore-Penrose inverse or pseudo-inverse and $I$ is the identity matrix. Therefore if $v_0^+$ is computable then
\begin{align}
v_0 T_{0,1}		&=	v_1\\
v_0^+ v_0 T_{0,1}	&=	v_0^{+}v_1\\
I T_{0,1}		&=	v_0^{+}v_1\\
T_{0,1}			&=	v_0^{+}v_1\\
\end{align}

To $v_0^+$ is computable as
\begin{equation}
v_0^+ = v_0^T\left(v_0v_0^T\right)^{-1}
\end{equation}

Unfortunately since $v_{0}$ is almost all zeros it follows that $v_{0}v_{0}^T$ is singular and its inverse $\left(v_{0}v_{0}^T\right)^{-1}$ does not exist. However in the limit
\begin{equation}
v_{0}^+ = \lim_{\delta \to 0} \left( A^*A + \delta I \right)^{-1} A^* = \lim_{\delta \to 0} A^* \left( A^*A + \delta I \right)^{-1}
\end{equation}
which is the Tikonov Regularization (wikipedia). Where $A^*$ is simply the transpose of $A$ is all real numbers and $\delta$ is an arbitrarily small number.
</p>
<h2>Relation to SVD and the Wiener filter (wikipedia)</h2>
<p>
Assume the SVD of $A$ exists (and I think it does in the case of $v_0$) then
$$
A = U \Sigma V^T
$$
with singular values $\sigma_i$. The Tikhonov regularized solution can than be expressed as
$$
\hat{x} = VDU^T\hat{b}
$$
where (I think in the Moore-Penrose $\hat{b}$ is a ones vector) and $D$ has diagonal values then,
$$
D_{i,i} = \frac{\sigma_i}{\sigma_i^2 + \delta^2}
$$
Notice that this implies that one should be able to remove the $\delta^2$ from the nonzero elements (where $\sigma_i\neq 0$) of the Tikonov Regularization. Would this help or hurt the accuracy of the computation of $T_{0,1}$ or generally $T_{i-1,i}$?
</p>
<!-- End Tags --!>
<div class="hspacer"></div>
</div>
</body>
</html>
